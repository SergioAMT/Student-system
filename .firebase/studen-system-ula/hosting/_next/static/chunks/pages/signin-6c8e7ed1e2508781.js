(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[176],{4758:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/signin",function(){return r(5764)}])},5764:function(e,n,r){"use strict";r.r(n),r.d(n,{SignInView:function(){return N},default:function(){return k}});var l=r(5944),t=r(7294),a=r(1163),i=r(948),o=r(7357),s=r(5582),u=r(8456),d=r(6624),c=r(710),m=r(3578);let f=e=>{let{steps:n,activeStep:r}=e;return(0,l.BX)(o.Z,{sx:{width:"100%"},children:[(0,l.tZ)(d.Z,{sx:{marginBottom:5},activeStep:1,alternativeLabel:!0,children:n.map(e=>(0,l.tZ)(c.Z,{children:(0,l.tZ)(m.Z,{children:e.label})},e.label))}),(0,l.tZ)(o.Z,{sx:{display:"flex",flexDirection:"column"},children:(0,l.tZ)(o.Z,{sx:{flex:1},children:n[r].component})})]})};var v=r(1903),g=r(1812),h=r(7536),p=r(377),Z=r(2365);let y=e=>{let{onFinish:n}=e,{enqueueSnackbar:r}=(0,p.Ds)(),{control:a,formState:{errors:i},handleSubmit:o,watch:s}=(0,h.cI)(),[u,d]=(0,t.useState)(!1),c=o(async e=>{d(!0);try{await (0,Z.Cp)(e.password)}catch(e){d(!1),console.log("ERROR",JSON.stringify(e)),r("Something is wromg",{variant:"error"});return}d(!1),n()});return(0,l.BX)(l.HY,{children:[(0,l.tZ)(h.Qr,{control:a,name:"password",rules:{required:{value:!0,message:"Password Requerida"},pattern:{value:/^(?=.*\d)(?=.*[a-zA-Z])[0-9a-zA-Z]{6,16}$/,message:"La contrase\xf1a debe tener entre 6 y 16 caracteres, al menos un caracter nunmerico y uno alfanumerico"}},render:e=>{var n,r;let{field:{onChange:t,value:a}}=e;return(0,l.tZ)(v.Z,{fullWidth:!0,type:"password",label:"contrase\xf1a",variant:"filled",margin:"normal",onChange:t,value:a,error:Boolean(null==i?void 0:null===(n=i.password)||void 0===n?void 0:n.ref),helperText:null==i?void 0:null===(r=i.password)||void 0===r?void 0:r.message})}}),(0,l.tZ)(h.Qr,{control:a,name:"confirmPassword",rules:{required:{value:!0,message:"Confirmar contrase\xf1a es requerido"}},render:e=>{var n,r;let{field:{onChange:t,value:a}}=e;return(0,l.tZ)(v.Z,{fullWidth:!0,type:"password",label:"confirmar contrase\xf1a",variant:"filled",margin:"normal",onChange:t,value:a,error:Boolean(null==i?void 0:null===(n=i.password)||void 0===n?void 0:n.ref),helperText:null==i?void 0:null===(r=i.confirmPassword)||void 0===r?void 0:r.message})}}),(0,l.tZ)(g.Z,{loading:u,onClick:c,fullWidth:!0,sx:{marginTop:5},variant:"contained",size:"large",children:"Siguiente"})]})};var w=r(9828),x=r(3974);let S=async e=>{try{let n=await (0,w.ET)((0,w.hJ)(x.F,"profile"),{user:{uuid:e.uuid,email:e.email},firstname:e.firstname,ci:e.ci,lastname:e.lastname,phone:e.phone});console.log(n)}catch(e){console.log(JSON.stringify(e))}};var b=r(7023);let C=()=>{let{control:e,formState:{errors:n},handleSubmit:r}=(0,h.cI)(),[i,o]=(0,t.useState)(!1),{push:s}=(0,a.useRouter)(),u=r(async e=>{o(!0);let n=(0,b.t)();n&&(await S({uuid:null==n?void 0:n.uid,email:null==n?void 0:n.email,firstname:e.firstname,ci:e.ci,lastname:e.lastname,phone:e.phone}),s("/teachers"))});return(0,l.BX)(l.HY,{children:[(0,l.tZ)(h.Qr,{control:e,name:"firstname",rules:{required:{value:!0,message:"Email Requerido"}},render:e=>{var r,t;let{field:{onChange:a,value:i}}=e;return(0,l.tZ)(v.Z,{fullWidth:!0,label:"Nombre",variant:"filled",margin:"normal",onChange:a,value:i,error:Boolean(null==n?void 0:null===(r=n.firstname)||void 0===r?void 0:r.ref),helperText:null==n?void 0:null===(t=n.firstname)||void 0===t?void 0:t.message})}}),(0,l.tZ)(h.Qr,{control:e,name:"lastname",rules:{required:{value:!0,message:"Email Requerido"}},render:e=>{var r,t;let{field:{onChange:a,value:i}}=e;return(0,l.tZ)(v.Z,{fullWidth:!0,label:"Apellido",variant:"filled",margin:"normal",onChange:a,value:i,error:Boolean(null==n?void 0:null===(r=n.lastname)||void 0===r?void 0:r.ref),helperText:null==n?void 0:null===(t=n.lastname)||void 0===t?void 0:t.message})}}),(0,l.tZ)(h.Qr,{control:e,name:"ci",rules:{required:{value:!0,message:"Email Requerido"}},render:e=>{var r,t;let{field:{onChange:a,value:i}}=e;return(0,l.tZ)(v.Z,{fullWidth:!0,label:"Cedula",variant:"filled",margin:"normal",onChange:a,value:i,error:Boolean(null==n?void 0:null===(r=n.ci)||void 0===r?void 0:r.ref),helperText:null==n?void 0:null===(t=n.ci)||void 0===t?void 0:t.message})}}),(0,l.tZ)(h.Qr,{control:e,name:"phone",rules:{required:{value:!0,message:"Email Requerido"}},render:e=>{var r,t;let{field:{onChange:a,value:i}}=e;return(0,l.tZ)(v.Z,{fullWidth:!0,label:"telefono",variant:"filled",margin:"normal",onChange:a,value:i,error:Boolean(null==n?void 0:null===(r=n.phone)||void 0===r?void 0:r.ref),helperText:null==n?void 0:null===(t=n.phone)||void 0===t?void 0:t.message})}}),(0,l.tZ)(g.Z,{loading:i,onClick:u,fullWidth:!0,sx:{marginTop:5},variant:"contained",size:"large",children:"REGISTRAR"})]})};var E=r(5675),R=r.n(E),B=r(5861);let _=()=>(0,l.BX)(o.Z,{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:4,children:[(0,l.tZ)(R(),{style:{marginRight:8},src:"/MIT_logo_bg.png",alt:"sidebar_logo",width:150,height:150}),(0,l.tZ)(B.Z,{variant:"h6",color:"GrayText",children:"Students System"})]}),I=(0,i.ZP)("div")({backgroundColor:"#fff",width:"100%",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"}),T=()=>{let{query:e}=(0,a.useRouter)(),[n,r]=(0,t.useState)(!1),[i,d]=(0,t.useState)(0),c=(0,t.useMemo)(()=>[{label:"Selecciona una contrasena",component:(0,l.tZ)(y,{onFinish:()=>d(1)})},{label:"Introduce tus datos",component:(0,l.tZ)(C,{})}],[]),m=async()=>{if("string"==typeof e.email){console.log("running",e);try{await (0,Z.Ry)(e.email),r(!1)}catch(e){console.log("error")}}};return(0,t.useEffect)(()=>{m()},[e]),(0,l.tZ)(I,{children:(0,l.BX)(s.Z,{maxWidth:"sm",children:[(0,l.tZ)(_,{}),n?(0,l.tZ)(o.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:300},children:(0,l.tZ)(u.Z,{})}):(0,l.tZ)(f,{activeStep:i,steps:c})]})})},N=()=>(0,l.tZ)(T,{});var k=N},2365:function(e,n,r){"use strict";r.d(n,{Cp:function(){return o},Mx:function(){return d},R2:function(){return i},Ry:function(){return s},w2:function(){return u}});var l=r(1259),t=r(7023),a=r(3974);let i=async e=>{let n=(0,l.v0)(a.l);try{await (0,l.oo)(n,e,{url:"".concat(window.location.origin,"/signin/?email=").concat(e),handleCodeInApp:!0,iOS:{bundleId:"com.example.ios"},android:{packageName:"com.example.android",installApp:!0,minimumVersion:"12"},dynamicLinkDomain:"studensystem.page.link"})}catch(e){e.code,e.message,console.log(JSON.stringify(e))}},o=async e=>{let n=(0,t.t)();if(!n)throw Error("Current user no found");try{await (0,l.gQ)(n,e),console.log("success")}catch(e){throw console.log(JSON.stringify(e)),Error("error change password")}},s=async e=>{let n=(0,l.v0)(a.l);if((0,l.JB)(n,window.location.href))try{await (0,l.P6)(n,e,window.location.href)}catch(e){throw console.log(JSON.stringify(e)),Error("Error")}},u=async(e,n)=>{let r=(0,l.v0)(a.l);try{await (0,l.e5)(r,e,n)}catch(e){throw console.log(JSON.stringify(e)),Error("Error signin user")}},d=async()=>{let e=(0,l.v0)(a.l);await (0,l.w7)(e)}},7023:function(e,n,r){"use strict";r.d(n,{t:function(){return a}});var l=r(1259),t=r(3974);let a=()=>{let e=(0,l.v0)(t.l);return e.currentUser}},3974:function(e,n,r){"use strict";r.d(n,{F:function(){return o},l:function(){return i}});var l=r(3977),t=r(9828);let a={apiKey:"AIzaSyBqrpleKoVZOhyTVjNk_PjhtxckulLWswY",authDomain:"studen-system-ula.firebaseapp.com",projectId:"studen-system-ula",storageBucket:"studen-system-ula.appspot.com",messagingSenderId:"520800956817",appId:"1:520800956817:web:aafad10ac808e68c8b6a30"};console.log(a);let i=(0,l.ZF)(a),o=(0,t.ad)(i)}},function(e){e.O(0,[16,18,626,94,497,536,476,774,888,179],function(){return e(e.s=4758)}),_N_E=e.O()}]);